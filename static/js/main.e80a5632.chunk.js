(this["webpackJsonpnkn-board"]=this["webpackJsonpnkn-board"]||[]).push([[0],{149:function(e,t){},282:function(e,t){},284:function(e,t){},294:function(e,t){},296:function(e,t){},321:function(e,t){},322:function(e,t){},327:function(e,t){},329:function(e,t){},336:function(e,t){},355:function(e,t){},378:function(e,t){},379:function(e,t){},503:function(e,t){},504:function(e,t){},505:function(e,t){},509:function(e,t,n){},511:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(264),u=n.n(a),o=n(142),s=n(9),i=n(7),f=function(){return Object(i.jsx)("main",{children:"lobby"})},l=n(267),b=n(3),p=n.n(b),h=n(23),j=n(143),v=n(268),d=n(28),O=n(144),g=n.n(O),w=Object(r.createContext)(),x=function(){var e=Object(r.useState)(null),t=Object(d.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(!1),u=Object(d.a)(a,2),o=u[0],s=u[1],i=function(){var e=Object(r.useState)(null),t=Object(d.a)(e,2),n=t[0],c=t[1];return Object(r.useEffect)((function(){c(new g.a.Wallet({rpcServerAddr:"http://mainnet-seed-0001.nkn.org:30003"}))}),[]),n}(),f=function(){var e=Object(h.a)(p.a.mark((function e(t,r){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.publish(t,JSON.stringify(r));case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t,n){return e.apply(this,arguments)}}(),l=function(){var e=Object(h.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.subscribe(t,4e5);case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=Object(h.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.unsubscribe(t);case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),j=function(){var e=Object(h.a)(p.a.mark((function e(t,r){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.send(t,JSON.stringify(r));case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t,n){return e.apply(this,arguments)}}(),v=function(){var e=Object(h.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.getSubscribers(t);case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),O=function(){var e=Object(h.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.getSubscription(t,n.addr);case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){i&&c(new g.a.MultiClient({seed:i.getSeed()}))}),[i]),Object(r.useEffect)((function(){n&&(n.onConnect((function(){s(!0)})),n.onMessage((function(e){var t=e.src,n=e.payload,r=JSON.parse(n);r.user=t,window.dispatchEvent(new CustomEvent(r.type,{detail:r}))})))}),[n]),{client:n,wallet:i,isConnected:o,publishTo:f,subscribeTo:l,unSubscribe:b,sendTo:j,onMessageType:function(e,t){window.addEventListener(e,t)},getSubscribers:v,getSubscription:O}},S=function(e){var t=e.children,n=x();return Object(i.jsx)(w.Provider,{value:n,children:t})},y="CANVAS_CHANGE",m=n(265),C=function(){var e=Object(r.useRef)(),t=Object(r.useRef)(),n=Object(s.f)(),c=Object(r.useState)(null),a=Object(d.a)(c,2),u=a[0],o=a[1],i=Object(r.useState)(300),f=Object(d.a)(i,2),l=f[0],b=f[1],O=Object(r.useState)(150),g=Object(d.a)(O,2),x=g[0],S=g[1],C=Object(r.useState)(""),E=Object(d.a)(C,2),k=E[0],N=E[1],R=Object(r.useContext)(w),I=R.onMessageType,T=R.publishTo,J=R.getSubscription,B=R.isConnected,A=R.unSubscribe,M=R.subscribeTo,D=function(e,t){var n,r=Object(v.a)(e),c=Object(j.a)(t);try{for(c.s();!(n=c.n()).done;){var a,u=n.value,o=!1,s=Object(j.a)(e);try{for(s.s();!(a=s.n()).done;){var i=a.value;JSON.stringify(i)===JSON.stringify(u)&&(o=!0)}}catch(f){s.e(f)}finally{s.f()}o||r.push(u)}}catch(f){c.e(f)}finally{c.f()}return r},G=function(){var e=Object(h.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=console,e.next=4,M(t);case 4:e.t1=e.sent,e.t0.log.call(e.t0,e.t1),e.next=11;break;case 8:e.prev=8,e.t2=e.catch(0),console.log(e.t2);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){if(B){var t=n.pathname.slice(1);t!==localStorage.getItem("subscription")&&A(localStorage.getItem("subscription")),N(t),G(t),localStorage.setItem("subscription",t),o(new m.fabric.Canvas(e.current))}}),[e,B]),Object(r.useEffect)((function(){if(u){u.isDrawingMode=!0;var e=setInterval(Object(h.a)(p.a.mark((function t(){var n;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,J(k);case 2:n=t.sent,console.log("CONNECTING WITH PEERS..."),(null===n||void 0===n?void 0:n.expiresAt)>0&&(console.log(n),console.log("SUBSCRIBED"),clearInterval(e));case 5:case"end":return t.stop()}}),t)}))),1e3);u.on("path:created",(function(e){T(k,{type:y,state:u})})),I(y,(function(e){var t=u.toObject(),n=Object.assign({},t,{objects:D(t.objects,e.detail.state.objects)});u.loadFromJSON(n)})),window.addEventListener("resize",(function(){var e=t.current.getBoundingClientRect(),n=e.width,r=e.height;b(n),S(r),u.renderAll()}))}}),[u]),Object(r.useEffect)((function(){}),[t,e]),Object(r.useEffect)((function(){var e=t.current.getBoundingClientRect(),n=e.width,r=e.height;b(n),S(r)}),[]),{canvasRef:e,canvas:u,parentRef:t,height:x,width:l}},E=(n(509),function(){var e=C(),t=e.canvasRef,n=e.canvas,r=e.parentRef,c=e.width,a=e.height;return Object(i.jsxs)("section",{ref:r,style:{width:"100vw",height:"80vh",backgroundColor:"white",borderRadius:"10px"},children:[Object(i.jsx)("canvas",{ref:t,width:c,height:a}),Object(i.jsx)("input",{type:"color",onChange:function(e){return n.freeDrawingBrush.color=e.target.value}}),Object(i.jsx)("input",{type:"range",min:"1",max:"50",defaultValue:"1",onChange:function(e){return n.freeDrawingBrush.width=e.target.value}})]})}),k=l.a.main({height:"100vh","--tw-bg-opacity":"1",backgroundColor:"rgba(59, 130, 246, var(--tw-bg-opacity))"}),N=function(){return Object(i.jsx)(k,{children:Object(i.jsx)(E,{})})};var R=function(){return Object(i.jsx)(o.a,{children:Object(i.jsxs)(s.c,{children:[Object(i.jsx)(s.a,{path:"/",exact:!0,component:f}),Object(i.jsx)(s.a,{path:"/:room",component:N})]})})};n(510);u.a.render(Object(i.jsx)(c.a.StrictMode,{children:Object(i.jsx)(S,{children:Object(i.jsx)(R,{})})}),document.getElementById("root"))}},[[511,1,2]]]);
//# sourceMappingURL=main.e80a5632.chunk.js.map